var fbpopup=$("#popp-feedback");var resultBlock=$(".result-block");function feedbackPopupShow(){fbpopup.addClass("show")}function feedbackPopupHide(){fbpopup.removeClass("show")}function feedbackShowError(c,b,a){var d={"email-empty":"Пожалуйста, заполните это поле корректно","phone-empty":"Пожалуйста, заполните это поле корректно","message-empty":"Сообщение должно содержать минимум 10 символов"};c.prev(".error-block").show().html(d[b]);setTimeout(function(){feedbackHideError();feedbackHideResult()},5000)}function feedbackHideError(){fbpopup.find(".error-block").hide()}function feedbackShowResult(a){resultBlock.html(a).show()}function feedbackHideResult(){resultBlock.hide()}function feedbackClearform(){fbpopup.find("input, textarea").val("")}function feedbackSend(){feedbackHideError();var d=fbpopup.find('input[name="name"]'),c=fbpopup.find('input[name="email"]'),a=fbpopup.find('input[name="phone"]'),e=fbpopup.find('textarea[name="message"]');var h=$.trim(d.val()),b=$.trim(c.val()),g=$.trim(a.val()),f=$.trim(e.val());if(b==""||(b.search(/^.+@.+\..+/i)+1)==false){feedbackShowError(c,"email-empty");feedbackShowResult("Не все поля заполненны верно");return false}if(f.length<10){feedbackShowError(e,"message-empty");feedbackShowResult("Не все поля заполненны верно");return false}$.ajax({type:"POST",url:"/feedback-send",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{name:h,email:b,phone:g,message:f},success:function(i){if(i=="success"){feedbackShowResult("Сообщение успешно отправлено");feedbackClearform()}else{feedbackShowResult("При отправке произошла ошибка. Пожалуйста, попробуйте позже")}},error:function(i){feedbackShowResult("При отправке произошла ошибка. Пожалуйста, попробуйте позже")}})}$(document).mousedown(function(a){var b=fbpopup.find(".window");if(!b.is(a.target)&&b.has(a.target).length===0){feedbackPopupHide()}});$(document).keyup(function(a){if(a.keyCode===27){feedbackPopupHide()}});